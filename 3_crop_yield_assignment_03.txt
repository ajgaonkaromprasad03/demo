assignment_03

dataset = https://www.kaggle.com/datasets/majidiqbalvhr/crop-yield-dataset

import pandas as pd
df = pd.read_csv('/content/sample_data/crop_yield.csv')
df.head()


Perform data visualization, build and train XGBoost, evaluate their accuracy.



import matplotlib.pyplot as plt
import seaborn as sns

# Scatter plots
plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
sns.scatterplot(data=df, x='Rainfall_mm', y='Yield_tons_per_hectare')
plt.title('Rainfall vs. Yield')

plt.subplot(1, 2, 2)
sns.scatterplot(data=df, x='Temperature_Celsius', y='Yield_tons_per_hectare')
plt.title('Temperature vs. Yield')

plt.tight_layout()
plt.show()





# Box plots for categorical features
categorical_features = ['Region', 'Soil_Type', 'Crop', 'Weather_Condition']
plt.figure(figsize=(15, 10))

for i, col in enumerate(categorical_features):
    plt.subplot(2, 2, i + 1)
    sns.boxplot(data=df, x=col, y='Yield_tons_per_hectare')
    plt.title(f'{col} vs. Yield')
    plt.xticks(rotation=45, ha='right')

plt.tight_layout()
plt.show()




Data preprocessing
Subtask:
Prepare the data for modeling, including handling categorical variables and splitting the data into training and testing sets.



from sklearn.model_selection import train_test_split

categorical_cols = df.select_dtypes(include='object').columns
df_encoded = pd.get_dummies(df, columns=categorical_cols, drop_first=True)

X = df_encoded.drop('Yield_tons_per_hectare', axis=1)
y = df_encoded['Yield_tons_per_hectare']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

display(X_train.head())
display(X_test.head())
display(y_train.head())
display(y_test.head())




Model building (xgboost)
Subtask:
Build and train an XGBoost Regressor model on the training data.


from xgboost import XGBRegressor

xgb_model = XGBRegressor(n_estimators=100, learning_rate=0.1, random_state=42)
xgb_model.fit(X_train, y_train)




from sklearn.metrics import mean_squared_error, r2_score

y_pred_xgb = xgb_model.predict(X_test)

mse_xgb = mean_squared_error(y_test, y_pred_xgb)
r2_xgb = r2_score(y_test, y_pred_xgb)

print(f'XGBoost Mean Squared Error: {mse_xgb}')
print(f'XGBoost R-squared: {r2_xgb}')








